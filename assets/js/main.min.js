$.fn.serializeObject=function(){var e={},a=this.serializeArray();return $.each(a,function(){e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e};var lrh={init:function(){$(document).foundation(),$("body").hasClass("home")&&lrh.homepage.init(),$("body").hasClass("hotel")&&lrh.hotel.init(),$("body").hasClass("restaurant")&&lrh.restaurant.init(),$("body").hasClass("contact")&&lrh.contact.init();var e=window.location.hash;""!=e&&"#"!=e&&$("html, body").animate({scrollTop:$(e.replace("_","")).offset().top},"slow"),$('a[href^="#"]').click(function(){return $("html, body").animate({scrollTop:$($(this).attr("href")).offset().top},"slow"),!1}),$(window).on("now resize",function(){})},wichSeason:function(e){var a=/(\d{2})\/(\d{2})\/(\d{4})/,t=new Date(options.seasons.high.start.replace(a,"$3-$2-$1")),r=new Date(options.seasons.high.end.replace(a,"$3-$2-$1"));return e.between(t,r)?1:0},homepage:{init:function(){}},hotel:{init:function(){var e=/(\d{2})\/(\d{2})\/(\d{4})/,a=new Date(options.seasons.low.start.replace(e,"$3-$2-$1")),t=new Date(options.seasons.low.end.replace(e,"$3-$2-$1")),r=new Date,s={monthsFull:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],weekdaysShort:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],today:"",clear:"Effacer",labelMonthNext:"Aller au mois suivant",labelMonthPrev:"Aller au mois précédent",format:"dd/mm/yyyy",formatSubmit:"dd/mm/yyyy",firstDay:1,max:t},o=$('input[name="start"]').pickadate($.extend({},s,{min:r.isAfter(a)?r:a,onSet:function(e){if(e.select){var a=new Date(e.select);l.pickadate("picker").set({min:a.addDays(1)})}}})),l=$('input[name="end"]').pickadate($.extend({},s,{min:r.isAfter(a)?r.addDays(1):a.addDays(1),onSet:function(e){if(e.select){var a=new Date(e.select);o.pickadate("picker").set({max:a.removeDays(1)})}}}));lrh.hotel.update_resa(),$('input[name="start"], input[name="end"]').on("change",function(){for(resa_f=$("#resa_form").serializeObject(),resa_f.start=new Date(resa_f.start.replace(e,"$3-$2-$1")),resa_f.end=new Date(resa_f.end.replace(e,"$3-$2-$1")),lrh.hotel.resa.nights=parseInt(resa_f.start.getDaysBetween(resa_f.end))<0?0:parseInt(resa_f.start.getDaysBetween(resa_f.end)),lrh.hotel.resa.high_season=0,lrh.hotel.resa.low_season=0,i=0;i<lrh.hotel.resa.nights;i++)resa_f.start.between(new Date(options.seasons.high.start.replace(e,"$3-$2-$1")),new Date(options.seasons.high.end.replace(e,"$3-$2-$1")))?lrh.hotel.resa.high_season++:lrh.hotel.resa.low_season++,resa_f.start.addDays(1);lrh.hotel.update_resa()}),$('input[name="adult"], input[name="kid"]').on("change",function(){resa_f=$("#resa_form").serializeObject(),lrh.hotel.resa.adult=""==resa_f.adult||parseInt(resa_f.adult)<0?0:parseInt(resa_f.adult),lrh.hotel.resa.kid=""==resa_f.kid||parseInt(resa_f.kid)<0?0:parseInt(resa_f.kid),lrh.hotel.resa.people=lrh.hotel.resa.adult+lrh.hotel.resa.kid,lrh.hotel.resa.adult<1?$('input[name="adult"]').parent().removeClass():$('input[name="adult"]').parent().removeClass().addClass(lrh.hotel.resa.adult>2?"plus":2==lrh.hotel.resa.adult?"two":"one"),lrh.hotel.resa.kid<1?$('input[name="kid"]').parent().removeClass():$('input[name="kid"]').parent().removeClass().addClass(lrh.hotel.resa.kid>2?"plus":2==lrh.hotel.resa.kid?"two":"one");var e={el:$("#rooms"),low:Math.ceil(lrh.hotel.resa.people/3),selected:Math.ceil(lrh.hotel.resa.people/2),high:lrh.hotel.resa.people};if(e.el.empty(),0!=lrh.hotel.resa.people){for(var a=e.low;a<=e.high;a++)e.el.append($("<option></option>").attr({value:a,selected:a==e.selected}).text(a));lrh.hotel.resa.rooms=e.selected,lrh.hotel.resa.extra_beds=0}else e.el.append($("<option></option>").attr({value:0,selected:!0}).text("-")),lrh.hotel.resa.rooms=0,lrh.hotel.resa.extra_beds=0;lrh.hotel.update_resa()}),$('select[name="rooms"]').on("change",function(){resa_f=$("#resa_form").serializeObject(),lrh.hotel.resa.rooms=parseInt(resa_f.rooms),lrh.hotel.resa.extra_beds=lrh.hotel.resa.people-2*lrh.hotel.resa.rooms<0?0:lrh.hotel.resa.people-2*lrh.hotel.resa.rooms,lrh.hotel.update_resa()}),$('select[name="room_type"]').on("change",function(){resa_f=$("#resa_form").serializeObject(),lrh.hotel.resa.room_type=parseInt(resa_f.room_type),lrh.hotel.update_resa()}),$('select[name="breakfast"]').on("change",function(){resa_f=$("#resa_form").serializeObject(),lrh.hotel.resa.breakfast=parseInt(resa_f.breakfast),lrh.hotel.update_resa()}),$('input[name="animals"]').on("change",function(){resa_f=$("#resa_form").serializeObject(),lrh.hotel.resa.animals=parseInt(resa_f.animals)<0||""==resa_f.animals?0:parseInt(resa_f.animals),lrh.hotel.update_resa()}),$("#resa_form").submit(function(e){if(e.preventDefault(),$form=$(this),$form.parsley("validate")){$form.find("button").attr({disabled:!0}).html("Envoi...");var a={action:"send_mail",type:"hotel",start:$form.find('[name="start"]').val(),end:$form.find('[name="end"]').val(),adult:$form.find('[name="adult"]').val(),kid:$form.find('[name="kid"]').val(),rooms:$form.find('[name="rooms"]').val(),beds:$form.find('[name="beds"]').val(),room_type:$form.find('[name="room_type"] option[value="'+$form.find('[name="room_type"]').val()+'"]').text(),breakfast:$form.find('[name="breakfast"] option[value="'+$form.find('[name="breakfast"]').val()+'"]').text(),animals:$form.find('[name="animals"]').val(),name:$form.find('[name="name"]').val(),tel:$form.find('[name="tel"]').val(),mail:$form.find('[name="mail"]').val(),spam:"nope"};xhr=$.ajax({type:"POST",url:wp.ajax,data:a,success:function(e){e.success?$form.find("button").html("Envoi réussi !"):$form.find("button").attr({disabled:!1}).html("Echec de l'envoi")}})}})},resa:{nights:0,adult:0,kid:0,people:0,rooms:0,extra_beds:0,room_type:0,breakfast:0,animals:0,low_season:0,high_season:0},update_resa_dom:function(e,a,t,r,s){var o=function(e,a,t,r){setTimeout(function(){e.text(a+"€"),e.removeClass(t)},r)};return e.text()!=a+"€"?(e.addClass(t),o(e,a,t,r),r+s):r},update_resa:function(){var e=lrh.hotel.resa.rooms*lrh.hotel.resa.low_season*options.hotel.prices.room[lrh.hotel.resa.room_type].low+lrh.hotel.resa.rooms*lrh.hotel.resa.high_season*options.hotel.prices.room[lrh.hotel.resa.room_type].high,a=lrh.hotel.resa.extra_beds*lrh.hotel.resa.nights*options.hotel.prices.extra_bed,t=lrh.hotel.resa.adult*lrh.hotel.resa.nights*options.hotel.prices.breakfast[lrh.hotel.resa.breakfast].adult+lrh.hotel.resa.kid*lrh.hotel.resa.nights*options.hotel.prices.breakfast[lrh.hotel.resa.breakfast].kid,r=lrh.hotel.resa.animals*lrh.hotel.resa.nights*options.hotel.prices.animal,s=Math.round(lrh.hotel.resa.people*lrh.hotel.resa.nights*options.hotel.prices.tax*100)/100,o=e+a+t+r+s,l=150,n=50;o>0?$("#resa_form").addClass("allow-submit"):$("#resa_form").removeClass("allow-submit"),l=lrh.hotel.update_resa_dom($("#nights"),e,"hide-color",l,n),l=lrh.hotel.update_resa_dom($("#extra_beds"),a,"hide-color",l,n),l=lrh.hotel.update_resa_dom($("#breakfast"),t,"hide-color",l,n),l=lrh.hotel.update_resa_dom($("#animals"),r,"hide-color",l,n),l=lrh.hotel.update_resa_dom($("#tax"),s,"hide-color",l,n),l=lrh.hotel.update_resa_dom($("#total"),o,"hide-color",l,n)}},restaurant:{init:function(){var e=/(\d{2})\/(\d{2})\/(\d{4})/,a=new Date(options.seasons.low.start.replace(e,"$3-$2-$1")),t=new Date(options.seasons.high.start.replace(e,"$3-$2-$1")),r=new Date(options.seasons.high.end.replace(e,"$3-$2-$1")),s=new Date(options.seasons.low.end.replace(e,"$3-$2-$1")),o=function(e,a,t,r){var s=new Date((new Date).getFullYear(),0,1),o=s.getFullYear();for(s.setDate(1);s.getDay()!==e;)s.setDate(s.getDate()+1);for(;s.getFullYear()===o;){var l=new Date(s.getTime());l.between(t,r)&&a.push(l),s.setDate(s.getDate()+7)}},l=new Date,n={monthsFull:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],weekdaysShort:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],today:"",clear:"Effacer",labelMonthNext:"Aller au mois suivant",labelMonthPrev:"Aller au mois précédent",format:"dd/mm/yyyy",formatSubmit:"dd/mm/yyyy",firstDay:1,min:l.isAfter(a)?l:a,max:s},i={0:{from:options.restaurant.noon.start,to:options.restaurant.noon.end},1:{from:options.restaurant.night.start,to:options.restaurant.night.end}},m=$('input[name="time"]').pickatime({clear:"Effacer",format:"HH:i",formatSubmit:"HH:i",interval:options.restaurant.interval,min:[12,0],max:[21,30],disable:[!0,i[0],i[1]]}),d=$('input[name="date"]').pickadate($.extend({},n,{onSet:function(e){if(e.clear&&m.pickatime("picker").set("enable",!0).set("disable",[i[0],i[1]]).set("disable","flip"),e.select){var a=new Date(e.select).getDay(),s=new Date(e.select);m.pickatime("picker").set("enable",!0).set("disable",[i[0],i[1]]).set("disable","flip"),s.between(t,r)?$.each(options.restaurant.regular.high,function(e,t){t.day==a&&(0==t.hour&&m.pickatime("picker").set("enable",!0).set("disable",[i[t.hour+1]]).set("disable","flip"),1==t.hour&&m.pickatime("picker").set("enable",!0).set("disable",[i[t.hour-1]]).set("disable","flip"))}):$.each(options.restaurant.regular.low,function(e,t){t.day==a&&(0==t.hour&&m.pickatime("picker").set("enable",!0).set("disable",[i[t.hour+1]]).set("disable","flip"),1==t.hour&&m.pickatime("picker").set("enable",!0).set("disable",[i[t.hour-1]]).set("disable","flip"))}),$.each(options.restaurant.unique,function(e,a){var t=new Date(a.day[0]+"-"+(a.day[1]+1)+"-"+a.day[2]);t.equals(s)&&(0==a.hour&&m.pickatime("picker").set("enable",!0).set("disable",[i[a.hour+1]]).set("disable","flip"),1==a.hour&&m.pickatime("picker").set("enable",!0).set("disable",[i[a.hour-1]]).set("disable","flip"))})}}})),h=[];$.each(options.restaurant.regular.low,function(e,l){2==l.hour&&(o(l.day,h,a,t),o(l.day,h,r,s))}),$.each(options.restaurant.regular.high,function(e,a){2==a.hour&&o(a.day,h,t,r)}),$.each(options.restaurant.unique,function(e,a){2==a.hour&&h.push(a.day)}),d.pickadate("picker").set({disable:h}),$('input[name="adult"], input[name="kid"]').on("change",function(){var e={};resa_f=$("#resa_form").serializeObject(),e.adult=""==resa_f.adult||parseInt(resa_f.adult)<0?0:parseInt(resa_f.adult),e.kid=""==resa_f.kid||parseInt(resa_f.kid)<0?0:parseInt(resa_f.kid),e.people=e.adult+e.kid,e.adult<1?$('input[name="adult"]').parent().removeClass():$('input[name="adult"]').parent().removeClass().addClass(e.adult>2?"plus":2==e.adult?"two":"one"),e.kid<1?$('input[name="kid"]').parent().removeClass():$('input[name="kid"]').parent().removeClass().addClass(e.kid>2?"plus":2==e.kid?"two":"one")}),$("#resa_form").submit(function(e){if(e.preventDefault(),$form=$(this),$form.parsley("validate")){$form.find("button").attr({disabled:!0}).html("Envoi...");var a={action:"send_mail",type:"restaurant",date:$form.find('[name="date"]').val(),time:$form.find('[name="time"]').val(),adult:$form.find('[name="adult"]').val(),kid:$form.find('[name="kid"]').val(),name:$form.find('[name="name"]').val(),tel:$form.find('[name="tel"]').val(),mail:$form.find('[name="mail"]').val(),spam:"nope"};xhr=$.ajax({type:"POST",url:wp.ajax,data:a,success:function(e){e.success?$form.find("button").html("Envoi réussi !"):$form.find("button").attr({disabled:!1}).html("Echec de l'envoi")}})}})}},contact:{init:function(){"object"==typeof google&&"object"==typeof google.maps&&setTimeout(function(){lrh.contact.initMap(document.getElementById("maps"),[50.632086,1.601128],10,[50.632086,1.601128],templateDir+"assets/img/map-marker.png","https://www.google.fr/maps/place/Logis+H%C3%B4tel+le+R%C3%A9gina/@50.632086,1.601128,17z/data=!3m1!4b1!4m2!3m1!1s0x47ddd30bf8b67273:0x23afbbb7da4cf5c6",Modernizr.touch)},600),$("#contact").submit(function(e){if(e.preventDefault(),$form=$(this),$form.parsley("validate")){$form.find("button").attr({disabled:!0}).html("Envoi...");var a={action:"send_mail",type:"contact",name:$form.find('[name="name"]').val(),mail:$form.find('[name="mail"]').val(),message:$form.find('[name="message"]').val(),spam:"nope"};xhr=$.ajax({type:"POST",url:wp.ajax,data:a,success:function(e){e.success?$form.find("button").html("Envoi réussi !"):$form.find("button").attr({disabled:!1}).html("Echec de l'envoi")}})}})},initMap:function(e,a,t,r,s,o,l){var n={center:new google.maps.LatLng(a[0],a[1]),zoom:t,zoomControl:!1,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL},disableDoubleClickZoom:l,mapTypeControl:!1,panControl:!1,scaleControl:!1,scrollwheel:!l,streetViewControl:!1,draggable:!l,overviewMapControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,styles:[{featureType:"road",elementType:"labels",stylers:[{visibility:"simplified"},{lightness:20}]},{featureType:"administrative.land_parcel",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"landscape.man_made",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"labels",stylers:[{visibility:"simplified"}]},{featureType:"road.local",elementType:"geometry",stylers:[{visibility:"simplified"}]},{featureType:"road.highway",elementType:"labels",stylers:[{visibility:"simplified"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.arterial",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{hue:"#a1cdfc"},{saturation:30},{lightness:49}]},{featureType:"road.highway",elementType:"geometry",stylers:[{hue:"#f49935"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{hue:"#fad959"}]}]},i=e,m=new google.maps.Map(i,n),d=new google.maps.Marker({icon:s,position:new google.maps.LatLng(r[0],r[1]),map:m});google.maps.event.addListener(d,"click",function(){var e=window.open(o,"_blank");e.focus()})}}};$(function(){lrh.init()});